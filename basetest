package tests;

import org.testng.annotations.DataProvider;
import utils.XLUtility;
import java.util.*;

public class BaseTest {
    protected static XLUtility excel = new XLUtility("testdata.xlsx");

    @DataProvider(name = "registerData")
    public Object[][] getRegisterData() throws Exception {
        return getDataFromExcel("Register");
    }

    @DataProvider(name = "getAllUsersData")
    public Object[][] getAllUsersData() throws Exception {
        return getDataFromExcel("GetAllUsers");
    }

    protected Object[][] getDataFromExcel(String testType) throws Exception {
        int rowCount = excel.getRowCount("Tests");
        int colCount = excel.getCellCount("Tests", 1);

        List<Object[]> dataList = new ArrayList<>();

        for (int i = 1; i <= rowCount; i++) {
            String type = excel.getCellData("Tests", i, 0); // column A = TestType
            if (type.equalsIgnoreCase(testType)) {
                Object[] rowData = new Object[colCount + 1];
                for (int j = 0; j < colCount; j++) {
                    rowData[j] = excel.getCellData("Tests", i, j);
                }
                rowData[colCount] = i; // rowIndex for writing result
                dataList.add(rowData);
            }
        }
        return dataList.toArray(new Object[0][]);
    }
}

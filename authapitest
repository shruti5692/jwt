package tests;

import base.BaseTest;
import io.restassured.http.ContentType;
import models.User;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;
import utils.ExcelUtils;

import static io.restassured.RestAssured.given;

public class AuthAPITest extends BaseTest {

    @DataProvider(name = "loginData")
    public Object[][] loginDataProvider() {
        String filePath = "src/test/resources/testdata.xlsx";
        var dataList = ExcelUtils.getData(filePath, "LoginData");
        return dataList.toArray(new Object[0][0]);
    }

    @Test(dataProvider = "loginData")
    public void testLogin(String username, String password) {
        User user = new User(username, password);

        given()
            .contentType(ContentType.JSON)
            .body(user)
        .when()
            .post("/auth/login")
        .then()
            .statusCode(200); // expecting login success
    }
}
